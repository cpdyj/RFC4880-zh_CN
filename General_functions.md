# 2. 一般功能
OpenPGP通过这些功能提供消息和文件完整性服务：
* 数字签名
* 加密
* 压缩
* Radix-64转换

此外，OpenPGP提供秘钥管理和证书功能，但其中的大多数超出了本文档的范围。

## 2.1 通过加密保证机密性
OpenPGP结合对称秘钥加密和公钥加密来提供机密性，第一个对象使用一个对称加密算法加密，对每个对象每个对称加密秘钥只使用一次 。一个新的“会话秘钥”为每个对象作为一个随机数生成（有时称为一个会话）。由于只使用一次，会话密钥绑定到消息并与之一起传输。为了保护密钥，它用接收方的公钥加密。顺序如下：

1. 发送方创建消息。
2. 发送OpenPGP仅为此条消息生成的随机数作为会话秘钥。
3. 这个会话秘钥使用每个接受者的公钥加密，这些“已加密的会话秘钥”作为消息的开头。
4. 发送OpenPGP使用会话秘钥加密的消息，它形成了消息的其余部分，注意通常消息是压缩的。
5. 接收方使用收件人的私钥解密会话密钥。
6. 接收方使用会话密钥解密消息。如果消息被压缩，它将被解压缩。

通过对称密钥加密，一个对象可以被一个通过密码（或其他共享的秘密）导出的秘钥加密，两阶段的机制类似于，会话密钥的对称算法密钥本身被一个共享密钥加密。

数字签名和加密服务可以被添加到同一条消息中。首先，一个通过消息生成的数字签名附加到这条消息上。之后消息和数字签名被对称的会话秘钥加密。最后，会话秘钥被公钥加密并作为前缀附加到加密块上。

## 2.2 通过数字签名认证
数字签名使用哈希码或消息摘要算法，和一个公钥加密算法。顺序如下：

1.	发送者创建消息。
2.	发送方软件生成消息的哈希码。
3.	发送方软件从哈希码生成一个数字签名使用发送方的私钥。
4.	二进制的签名附加到消息上。
5.	接收方软件保留这条消息的数字签名的一个拷贝。
6.	接收方软件从接收到的消息生成一个新的哈希码并使用消息的数字签名验证。如果验证成功，消息通过认证。

## 2.3 压缩
OpenPGP的实现**应该**在附加数字签名后加密前压缩消息。
如果没有实现压缩，它的作者应该意识到这个世界上的大多数OpenPGP消息都是被压缩过的。因此，在空间受限的情况下实现解压缩是明智的，而不是压缩。

此外，压缩具有附加的作用，某些类型的攻击可能受到阻碍，即轻微改变的压缩数据很少在没有严重错误的情况下解压缩。 这不是绝对的，但它在操作上是有用的。 通过执行和使用修改检测代码可以严格防止这些攻击，将在以下各节讲述。

## 2.4 转换到Radix-64
OpenPGP对加密消息，签名证书和密钥的底层本地表示是一串任意8bit字节。
一些系统只允许使用由7bit可打印文本组成的块。 要通过对原始二进制数据不安全的通道传输OpenPGP的原始二进制8bit字节，需要打印这些二进制8bit字节的编码。OpenPGP提供将原始8bit二进制字节流转换为可打印ASCII字符流的服务，称为Radix-64编码或ASCII装甲。
实现**应该**提供Radix-64转换。

## 2.5 仅签名应用
OpenPGP被设计用于同时加密和签名，然而这里有几个问题可以通过仅签名解决。尽管规范要求同时加密和签名，在不加密的情况下实现它们的子集是合理的。
