# 3. 数据元素格式

本章节介绍了 OpenPGP 使用的数据元素格式

# 3.1. 纯量数字

纯量数字是无符号的，并且总是存储为大端模式。使用 `n[k]` 代表第 k 个字节，两字节的纯量数字值是 `((n[0] << 8) + n[1])` 。四字节纯量数字的值是 `((n[0] << 24) + (n[1] << 16) + (n[2] << 8) + n[3])` 。

# 3.2. 多精度整数

多精度整数（也叫 MPIs）是一种无符号整数用来存储例如加密计算所需要的大整数。

一个 MPIs 包含两部分：一个双字节的标量作为 MPI 的位长度，接着一个包含着实际整数的序列。

这些字节是大端数字；一个大端数字通过前缀长度构成一个 MPI

举例（所有数字使用十六进制）：

字节序列 `[00 01 01]` 表示一个值为 1 的 MPI。字节序列 `[00 09 01 FF]` 表示一个值为 511 的 MPI。

附加规则：

* MPI 的长度是 `((MPI.length + 7) / 8) + 2` 字节

* MPI 的长度起始于最高有效非0位。比如， `[00 02 01]` 格式不是正确的，它应该是 `[00 02 01]`

* 未使用的位必须为 0

* 当 MPI 是加密的，长度来自明文的 MPI ，在密文中格式可能不是正确的